# 区块链数据管理指南

## 数据文件说明

本项目使用 BadgerDB 作为区块链数据的存储引擎。BadgerDB 是一个高性能的 key-value 存储引擎，它会在 `data/blockchain/` 目录下生成一系列数据文件：

- `.vlog` 文件：值日志文件，存储实际的数据内容
- `.mem` 文件：内存表文件，用于索引和查找
- `MANIFEST`：存储数据库元数据
- `LOCK`：数据库锁文件
- `DISCARD`：垃圾回收相关文件

这些文件包含区块链的全部数据，包括区块、交易记录等。由于区块链数据会随着使用而不断增长，这些文件可能会变得非常大。

## Git版本控制注意事项

**重要：这些数据文件不应该被包含在版本控制系统中。**

原因如下：
1. 数据文件可能非常大，超过GitHub的100MB文件大小限制
2. 这些文件经常变化，会导致仓库体积迅速增长
3. 每个开发者或用户应该有自己的区块链数据副本

我们已经在 `.gitignore` 文件中配置了忽略这些数据文件的规则。

## 如何处理数据文件

### 首次克隆项目

当你首次克隆项目时，数据目录会是空的。程序会在首次运行时创建必要的数据文件。

### 备份数据

如果你需要备份区块链数据，请使用以下方法之一：

1. 将 `data/blockchain/` 目录复制到安全的位置
2. 使用区块链导出功能（如果已实现）导出数据
3. 对于重要数据，考虑使用专门的备份工具

### 共享测试数据

如果需要共享测试数据，请考虑以下方式：

1. 创建一个区块链导出文件（JSON或其他格式）
2. 使用大文件存储服务（如Google Drive, Dropbox等）分享数据目录的压缩包
3. 对于团队开发，考虑设置一个共享的测试节点

## 恢复已推送的大文件错误

如果你不小心将数据文件推送到了远程仓库，请按照以下步骤处理：

1. 执行 `clean_git.sh` 脚本移除Git历史中的大文件
2. 强制推送更新后的仓库：`git push origin --force`

注意：强制推送会改变仓库历史，可能影响其他协作者。请在执行前通知团队成员。 